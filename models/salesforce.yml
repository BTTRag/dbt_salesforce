# version: 2

# models:

#   - name: salesforce_manager_performance
#     description:
#     columns:
#       - name: 
#         description: 
#         tests:
#           - unique
#           - not_null

#       - name: 
#         description: 

#       - name: 
#         description: 

#   - name: salesforce_owner_performance
#     description:
#     columns:
#       - name: 
#         description: 
#         tests:
#           - unique
#           - not_null

#       - name: 
#         description: 

#       - name: 
#         description:      

#   - name: salesforce_opportunity_enhanced
#     description: >
#       This table both cleans and enhances your opportunities source table with information about
#       the associate account and opportunity owner.
#     columns:
#       - name: opportunity_id
#         description:
#         tests:
#           - unique
#           - not_null
#       - name: opportunity_account_id
#         description:
#       - name: amount
#         description:
#       - name: probability
#         description:
#       - name: created_date
#         description:
#       - name: is_won
#         description:
#       - name: is_closed
#         description:
#       - name: forecast_category
#         description:
#       - name: stage_name
#         description:
#       - name: owner_id
#         description:
#       - name: close_date
#         description:
#       - name: is_created_this_month
#         description: Boolean field, indicating whether the created date is greater than or equal to the first day of this month.
#       - name: is_created_this_quarter
#         description: Boolean field, indicating whether the created date is greater than or equal to the first day of this quarter.
#       - name: days_since_created
#         description: The difference is days between the current day and the day the opportunity was created.
#       - name: days_to_close
#         description: The difference is days between the close day and the day the opportunity was created.
#       - name: is_closed_this_month
#         description: Boolean field, indicating whether the closed month is equal to the current month.
#       - name: is_closed_this_quarter
#         description: Boolean field, indicating whether the closed quarter is equal to the current quarter.
#       - name: account_id
#         description:
#       - name: account_name
#         description:
#       - name: industry
#         description:
#       - name: number_of_employees
#         description:
#       - name: account_source
#         description:
#       - name: account_rating
#         description:
#       - name: annual_revenue
#         description:
#       - name: opportunity_owner_user_id
#         description:
#       - name: opportunity_owner_name
#         description:
#       - name: opportunity_owner_city
#         description:
#       - name: opportunity_owner_state
#         description:
#       - name: status
#         description:
#       - name: created_amount_this_month
#         description:
#       - name: created_amount_this_quarter
#         description:
#       - name: created_count_this_month
#         description:
#       - name: created_count_this_quarter
#         description:
#       - name: closed_amount_this_month
#         description:
#       - name: closed_amount_this_quarter
#         description:
#       - name: closed_count_this_month
#         description:
#       - name: closed_count_this_quarter
#         description:

#   - name: salesforce_sales_snapshot
#     description: >
#       This snapshot provides monthly and quarterly metrics that help you understand how your opportunities
#       are performing. Metrics around bookings, the current pipeline and loses are included.
#     columns:
#       - name: bookings_amount_closed_this_month
#         description: 
#       - name: bookings_amount_closed_this_quarter
#         description: 
#       - name: total_number_bookings
#         description: 
#       - name: total_bookings_amount
#         description: 
#       - name: bookings_count_closed_this_month
#         description: 
#       - name: bookings_count_closed_this_quarter
#         description: 
#       - name: avg_bookings_amount
#         description: 
#       - name: largest_booking
#         description: 
#       - name: avg_days_to_close
#         description: 
#       - name: pipeline_created_amount_this_month
#         description: 
#       - name: pipeline_created_amount_this_quarter
#         description: 
#       - name: pipeline_created_forecast_amount_this_month
#         description: 
#       - name: pipeline_created_forecast_amount_this_quarter
#         description: 
#       - name: pipeline_count_created_this_month
#         description: 
#       - name: pipeline_count_created_this_quarter
#         description: 
#       - name: total_number_pipeline
#         description: 
#       - name: total_pipeline_amount
#         description: 
#       - name: total_pipeline_forecast_amount
#         description: 
#       - name: avg_pipeline_opp_amount
#         description: 
#       - name: largest_deal_in_pipeline
#         description: 
#       - name: win_percent_all_time
#         description: 
#       - name: avg_days_open
#         description: 
#       - name: lost_amount_this_month
#         description: 
#       - name: lost_amount_this_quarter
#         description: 
#       - name: total_number_lost
#         description: 
#       - name: total_lost_amount
#         description: 
#       - name: lost_count_this_month
#         description: 
#       - name: lost_count_this_quarter
#         description: 
#       - name: win_percent_this_month
#         description: 
#       - name: win_percent_this_quarter
#         description: 


#   # - name: manager_performance
#   #   description: >
#   #       This query is structured similar to rep performance, but each CTE join opportunties to users to pull in the manager field.
#   #       For the final query, the fields are aggregated a second time to count the number of distinct owner_ids
#   #       the final having clause is used to only pull in users who are managing other users who own opportunities.
  
#   # - name: owner_performance
#   #   description: >
#   #       Similar to opportunity overview, this uses three common table expressions to aggregate data from opportunities, but here it is grouped by owner_id.
#   #       Each of the CTEs are full outer joined with the user table to capture any opportunities without owner or user's without opportunities.
#   #         user_roles is left joined to only pull in roles for users who own opportunities
#   #       most fields are coalesced to 0 if a rep does not own any appropriate opportunities (avg time fields are not to differentiate from a rep having an average of 0 days).

#   # - name: opportunity overview
#   #   description: >
#   #       

#   #       Within each CTE, there are fields for the number of opportunities and their total amount. 
#   #       The first two check if the activity happened this month or quarter
#   #         for pipeline is checks when the opportunity was created
#   #         for bookings and lost opportunities it checks when the opportunity was closed (which is when it was won cause we filter for only won opportunties)
#   #       bookings_data and pipeline_data have a few additional summary fields: time opportunities are open, the overall average amount, and largest amount.
#   #       The final select pulls from all three tables and doesn't need a join because the CTE's are already aggregated to 1 row

#   #       # Ops raw data:
#   #       # This query is un-aggregated data about opportunities and their associated accounts and owners.
#   #       # The only two transformed fields are:
#   #       #   A stauts field that follows the other queries' logic if the opporuntiy is won, lost or in the pipeline
#   #       #   The number of days the opportunity has been open.  If the opportunity is still open, the current date is used.